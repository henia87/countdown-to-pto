<div class="countdown-container" [class.grinch-theme]="grinchMode">
  @if (!countdownComplete()) {
  <!-- Main Countdown Display -->
  <div class="countdown-header">
    <h1 class="title">
      {{
        grinchMode
          ? "ğŸ˜’ Grinch Countdown ğŸ˜’"
          : "ğŸ„ Christmas Leave Countdown ğŸ„"
      }}
    </h1>
    <p class="subtitle">
      {{ grinchMode ? "Doom approaches..." : "Freedom approaches..." }} December
      19, 2025 at 6:00 PM
    </p>

    <!-- Toggles Container -->
    <div class="toggles-container">
      <!-- December 13th Toggle -->
      <div class="toggle-wrapper">
        <label class="toggle-label">
          <span class="toggle-text">âš ï¸ Working Dec 13th?</span>
          <div class="toggle-switch">
            <input
              type="checkbox"
              [(ngModel)]="workingDecember13th"
              id="dec13-toggle"
            />
            <span class="slider"></span>
          </div>
        </label>
      </div>

      <!-- Traitor Tracking Toggle -->
      <div class="toggle-wrapper">
        <label class="toggle-label">
          <span class="toggle-text">ğŸ® Track Traitor?</span>
          <div class="toggle-switch">
            <input
              type="checkbox"
              [(ngModel)]="trackingTraitor"
              id="traitor-toggle"
            />
            <span class="slider"></span>
          </div>
        </label>
      </div>

      <!-- Grinch Mode Toggle -->
      <div class="toggle-wrapper">
        <label class="toggle-label">
          <span class="toggle-text">ğŸ’š Grinch Mode</span>
          <div class="toggle-switch">
            <input
              type="checkbox"
              [(ngModel)]="grinchMode"
              (change)="toggleGrinchMode()"
              id="grinch-toggle"
            />
            <span class="slider"></span>
          </div>
        </label>
      </div>
    </div>

    <p class="milestone-message">{{ getMilestoneMessage() }}</p>
    <p class="funny-quote">{{ currentFunnyQuote }}</p>
  </div>

  <!-- Time Units Display -->
  <div class="time-units">
    <!-- Weeks -->
    <div class="time-unit">
      <div class="time-value">
        {{ formatNumber(adjustedRemainingTime().weeks) }}
      </div>
      <div class="time-label">WEEKS</div>
    </div>

    <!-- Days -->
    <div class="time-unit">
      <div class="time-value">
        {{ formatNumber(adjustedRemainingTime().days) }}
      </div>
      <div class="time-label">DAYS</div>
    </div>

    <!-- Hours -->
    <div class="time-unit">
      <div class="time-value">
        {{ formatNumber(adjustedRemainingTime().hours) }}
      </div>
      <div class="time-label">HOURS</div>
    </div>

    <!-- Minutes -->
    <div class="time-unit">
      <div class="time-value">
        {{ formatNumber(adjustedRemainingTime().minutes) }}
      </div>
      <div class="time-label">MINUTES</div>
    </div>

    <!-- Seconds -->
    <div class="time-unit">
      <div class="time-value">
        {{ formatNumber(adjustedRemainingTime().seconds) }}
      </div>
      <div class="time-label">SECONDS</div>
    </div>
  </div>

  <!-- Progress Bar -->
  <div class="progress-section">
    <div class="progress-bar">
      <div class="progress-fill" [style.width.%]="progress()"></div>
    </div>
    <div class="progress-text">{{ progress() }}% Complete</div>
  </div>

  <!-- Traitor Tracking Stats (when toggled) - Under progress bar with spacing -->
  @if (trackingTraitor) {
  <div class="traitor-stats">
    <h3 class="traitor-title">ğŸ® Traitor Tracking Status</h3>
    @if (!isTraitorFree()) {
    <!-- Before Dec 13 -->
    <p class="stat-item">
      ğŸ–ï¸ Workdays until the traitor's escape: {{ workdaysUntilTraitorEscape() }}
    </p>
    <p class="stat-item">â° Hours of freedom they'll have before you: 168</p>
    } @else {
    <!-- After Dec 13 -->
    <p class="stat-item">
      ğŸ˜ Days the traitor has been free: {{ daysTraitorHasBeenFree() }}
    </p>
    <p class="stat-item">
      ğŸ“§ Emails you've answered while they relax:
      {{
        emailsWhileTraitorRelaxes() > 0
          ? emailsWhileTraitorRelaxes().toLocaleString()
          : "Too many"
      }}
    </p>
    <p class="stat-item">â˜• Your jealousy level: MAXIMUM</p>
    }
  </div>
  }

  <!-- Fun Statistics -->
  <div class="stats">
    <p class="stat-item">
      ğŸ“Š Total Days Until Freedom: {{ adjustedRemainingTime().totalDays }}
    </p>
    <p class="stat-item">
      â° Total Hours: {{ adjustedRemainingTime().totalHours.toLocaleString() }}
    </p>
    <p class="stat-item">ğŸ¢ Office Days Left: {{ officeDaysRemaining() }}</p>
    <p class="stat-item">ğŸ’¼ Workdays Left: {{ workdaysRemaining() }}</p>
    <p class="stat-item">
      â±ï¸ Work Hours Left: {{ workHoursRemaining().toLocaleString() }}
    </p>
  </div>

  <!-- Developer Excuse Generator -->
  <div class="excuse-generator">
    <h3 class="excuse-title">ğŸ¤– Developer Excuse Generator</h3>
    <button class="excuse-btn" (click)="generateExcuse()">
      Generate Excuse
    </button>
    @if (currentExcuse) {
    <div class="excuse-display">
      <p>"{{ currentExcuse }}"</p>
    </div>
    }
  </div>
  } @else {
  <!-- Celebration Message -->
  <div class="celebration">
    <div class="santa-sleigh">ğŸ›·ğŸ…ğŸ¦ŒğŸ¦ŒğŸ¦Œ</div>
    <h1 class="celebration-title">ğŸ‰ YOU'RE FREE! ğŸ‰</h1>
    <p class="celebration-message">Christmas leave has STARTED! ğŸ„âœ¨</p>
    <p class="celebration-subtitle">Merry Christmasing! Time to relax! ğŸ…</p>
    <audio
      id="celebration-sound"
      src="sounds/jingle-bells.mp3"
      preload="auto"
    ></audio>
  </div>
  }
</div>
